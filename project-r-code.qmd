```{r}
#| label: load-pkgs
#| message: false
library(tidyverse)
```

```{r}
#| label: load-data
workout_data <- read_csv("datasets/workout_preferences_data.csv")
transportation_data <- read_csv("datasets/transportation_data.csv")
social_media_data <- read_csv("datasets/social_media_data.csv")
pet_ownership_data <- read_csv("datasets/pet_ownership_data.csv")

coffee_data <- read_csv("datasets/coffee_consumption.csv")
recycling_data <- read_csv("datasets/durham_recycling.csv")
outdoors_data <- read_csv("datasets/nc_outdoor_survey.csv")
activity_data <- read_csv("datasets/physical_activity.csv")
sleep_data <- read_csv("datasets/screen_time_sleep.csv")
spotify_data <- read_csv("datasets/spotify_listening_habits.csv")

garden_data <- read_csv("datasets/garden.csv")
college_career_data <- read_csv("datasets/college_career.csv")
library_data <- read_csv("datasets/library.csv")
fair_data <- read_csv("datasets/state_fair.csv")
credit_data <- read_csv("datasets/credit_cards.csv")
school_supplies_data <- read_csv("datasets/school_supplies.csv")
```

Bar Chart Template:
```{r}
#| label: bar-chart-template

ggplot() + 
  geom_bar() +
  labs(x = "Category of [population]", y = "Metric") +
  theme_minimal()
```
Bar chart example:

```{r}
#| label: garden-bar-chart

garden_data |>
  mutate(site_location = ifelse(site_location == "Centralish", 
                                "Central", site_location)) |>
  ggplot(aes(x = site_location, y = current_volunteer_count)) +
  geom_col(fill = "steelblue", width = 0.3) +
  scale_y_continuous(breaks = c(0, 25, 50, 75, 100), 
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = "Site Location", y = "Volunteers", 
  title = "Current Volunteer Count by Garden Site") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  # Bigger x-axis labels
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(face = "bold", hjust = 0.5),
    panel.grid.major = element_blank(),  # Remove major gridlines
    panel.grid.minor = element_blank()   # Remove minor gridlines
  )

ggsave("garden_barchart.png", device = "png", width = 8, height = 5)
```


Scatter Plot Template:
```{r}
#| label: scatter-plot-template
ggplot() + 
  geom_point() +
  labs() +
  theme_minimal()
```


Scatter Plot Example
```{r}

volume_data <- spotify_data %>% 
  filter(Measure == "AvgVolumeLevel")

volume_data <- volume_data %>% 
  mutate(TimeOfDay = factor(TimeOfDay, 
                            levels = c("Morning", "Afternoon", "Evening", "Night")))

#| label: scatter-plot-template
ggplot(volume_data, aes(x = TimeOfDay, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title = "Average Volume Level by Time of Day",
    x = " ",
    y = "Volume Level\n(dB)"
  ) +
  theme_classic() +
  theme(
  axis.text.x = element_text(size = 14),
  axis.title.x = element_text(size = 16),
  axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
  plot.title = element_text(
    face = "bold",
    hjust = 0.5,
    size = 18,                       # Bigger title
    margin = margin(b = 50)          # Adds space *below* the title
  ),
  axis.ticks.x = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank()
)


```

Lollipop chart template:

```{r}
#| label: lollipop-chart-template
ggplot() +
  geom_segment() +
  geom_point(size = 3) +
  labs(
    title = "",
    x = "",
    y = ""
  )
```

Lollipop chart example:

```{r}
#| label: lollipop-chart-workout
library(grid)

ymax <- max(workout_data$time_per_week_minutes, na.rm = TRUE)
yupper <- max(200, ceiling(ymax / 50) * 50)

workout_data <- workout_data |>
  mutate(workout_type = factor(workout_type, 
                               levels = c("Cardio", "Strength Training", 
                                         "Yoga", "Sports/Classes")))

p <- ggplot(workout_data, aes(x = workout_type, y = time_per_week_minutes)) +
  geom_segment(aes(xend = workout_type, yend = 0),
               color = "steelblue", linewidth = 2.3) +
  geom_point(color = "steelblue", size = 9) +
  labs(
    title = "Average Time Spent Working Out by Workout Type",
    x = NULL,
    y = NULL
  ) +
  scale_y_continuous(
    limits = c(0, yupper),
    breaks = seq(0, yupper, by = 50),
    expand = expansion(mult = c(0, 0.05))
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(
      size = 16,
      face = "bold", 
      vjust = 1,
      hjust = 0.5, 
      margin = margin(t = -20, b = 50)
    ),
    plot.margin = margin(45, 40, 25, 40),
    axis.text.x = element_text(size = 14, color = "black"),
    axis.text.y = element_text(size = 14, color = "black"),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_line(color = "black"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  ) +
  annotation_custom(
    grob = textGrob(
      label = "Time per Week\n(minutes)", 
      hjust = 0.5,
      vjust = -0.65,
      gp = gpar(fontsize = 14)
    ),
    ymin = yupper,
    ymax = yupper,
    xmin = 0.5,
    xmax = 0.5
  ) +
  coord_cartesian(clip = "off")

# Build the plot and turn off clipping
gt <- ggplot_gtable(ggplot_build(p))
gt$layout$clip[gt$layout$name == "panel"] <- "off"
grid.draw(gt)

# Save the plot
ggsave("workout_lollipop.png", plot = gt, device = "png", width = 8, height = 5)
```
Sam's Stimuli:

Coffee Data Story
```{r}
#| label: coffee-bar-chart

coffee_data <- coffee_data |>
  mutate(AgeGroup = factor(AgeGroup, levels = c("18-24", "25-34", "35-44", "45-54", "55+")))

coffee_data |>
  filter(Measure == "CupsPerDay") |>
  ggplot(aes(x = AgeGroup, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 3, 0.5),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Avg. Cups / Day", 
       title = "Avg. Cups of Coffee per Day by Age") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )


ggsave("coffee_cups_per_day.png", device = "png", width = 8, height = 5)

```

```{r}
#| label: coffee-lollipop

ymax <- max(coffee_data$Value[coffee_data$Measure == "PercentDrinkingBlack"], na.rm = TRUE)
yupper <- max(50, ceiling(ymax / 10) * 10)  # Round up to nearest 10

coffee_data |>
  filter(Measure == "PercentDrinkingBlack") |>
  ggplot(aes(x = AgeGroup, y = Value)) +
  geom_segment(aes(xend = AgeGroup, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "Percent Who Drink Coffee Black by Age",
    x = " ",
    y = "% Drinking Black"
  ) +
  scale_y_continuous(
    limits = c(0, yupper),
    breaks = seq(0, yupper, by = 10),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")


ggsave("coffee_%_black_lollipop.png", device = "png", width = 14, height = 8)



```

```{r}
#| label: coffee-scatter

coffee_data |>
  filter(Measure == "MonthlySpending") |>
  ggplot(aes(x = AgeGroup, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 50)) +
  labs(
    title = "Avg. Monthly $ Spent on Coffee by Age",
    x = " ",
    y = "Monthly $"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("coffee_$_Scatter.png", device = "png", width = 14, height = 8)

```
Activity Data Story
```{r}
#| label: activity-bar-chart

activity_data |>
  filter(Measure == "AvgDailySteps") |>
  ggplot(aes(x = Location, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 9000, 2000),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Avg. Steps / Day", 
       title = "Avg. Steps per Day by Location") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )


ggsave("activity_steps.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: activity-lollipop

df <- activity_data |> filter(Measure == "PercentStrengthTraining")

ymax <- max(df$Value, na.rm = TRUE)
yupper <- max(50, ceiling(ymax / 10) * 10)


activity_data |>
  filter(Measure == "PercentStrengthTraining") |>
  ggplot(aes(x = Location, y = Value)) +
  geom_segment(aes(xend = Location, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "Percent Who Weight Train by Location",
    x = " ",
    y = "% Who\nWeight Train"
  ) +
  scale_y_continuous(
    limits = c(0, yupper),
    breaks = seq(0, yupper, by = 10),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")


ggsave("activity_weights_lollipop.png", device = "png", width = 14, height = 8)


```

```{r}

#| label: activity-scatter

activity_data |>
  filter(Measure == "SedentaryHours") |>
  ggplot(aes(x = Location, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 10)) +
  labs(
    title = "Avg. Sedentary Hours by Location",
    x = " ",
    y = "Sedentary Hours"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("activity_sedentary_Scatter.png", device = "png", width = 14, height = 8)

```
Recycling Data Story
```{r}
#| label: recycling-bar-chart

recycling_data |>
  filter(Measure == "KgRecyclingPerWeek") |>
  ggplot(aes(x = HomeType, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 10, 1),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Kg Recycling", 
       title = "Avg. Kg of Recycling per Week by Home Type") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )


ggsave("recycling_kg.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: recycling-lollipop

df <- recycling_data |> filter(Measure == "PercentEnrolled")

ymax <- max(df$Value, na.rm = TRUE)
yupper <- max(50, ceiling(ymax / 10) * 10)


recycling_data |>
  filter(Measure == "PercentEnrolled") |>
  ggplot(aes(x = HomeType, y = Value)) +
  geom_segment(aes(xend = HomeType, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "% Enrolled in Community Recycling Program by Home Type",
    x = " ",
    y = "% Enrolled"
  ) +
  scale_y_continuous(
    limits = c(0, yupper),
    breaks = seq(0, yupper, by = 10),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")


ggsave("recycling_enrollment_lollipop.png", device = "png", width = 14, height = 8)

```

```{r}
#| label: recycling-scatter

recycling_data |>
  filter(Measure == "ContaminationRate") |>
  ggplot(aes(x = HomeType, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 30)) +
  labs(
    title = "Avg. Contamination Rate by Home Type",
    x = " ",
    y = "% Contaminated"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("recycling_contam_Scatter.png", device = "png", width = 14, height = 8)
```
Spotify data story
```{r}
#| label: spotify-bar-chart
spotify_data <- spotify_data |>
  mutate(
    TimeOfDay = factor(TimeOfDay,
                       levels = c("Morning", "Afternoon", "Night"))
  )

spotify_data |>
  filter(Measure == "AvgListeningDuration") |>
  ggplot(aes(x = TimeOfDay, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 60, 10),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Duration\n(mins)", 
       title = "Avg. Listening Duration by Time of Day") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )

ggsave("Spotify_duration_bar.png", device = "png", width = 8, height = 5)

```

```{r}
#| label: spotify-lollipop

df <- spotify_data |> filter(Measure == "AvgSongTempo")

ymax <- max(df$Value, na.rm = TRUE)
yupper <- max(50, ceiling(ymax / 10) * 10)


spotify_data |>
  filter(Measure == "AvgSongTempo") |>
  ggplot(aes(x = TimeOfDay, y = Value)) +
  geom_segment(aes(xend = TimeOfDay, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "Avg. Song Tempo by Time of Day",
    x = " ",
    y = "Tempo\n(bpm)"
  ) +
  scale_y_continuous(
    limits = c(0, yupper),
    breaks = seq(0, yupper, by = 25),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")

ggsave("Spotify_tempo_lollipop.png", device = "png", width = 8, height = 5)

```

```{r}
#| label: spotify-scatter

spotify_data |>
  filter(Measure == "AvgVolumeLevel") |>
  ggplot(aes(x = TimeOfDay, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title = "Avg. Volume Level by Time of Day",
    x = " ",
    y = "Volume Level\n(dB)"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("spotify_volume_Scatter.png", device = "png", width = 14, height = 8)
```
Screen Time Data Story
```{r}
#| label: screentime-bar
sleep_data |>
  filter(Measure == "AvgSleepDuration") |>
  ggplot(aes(x = PhoneUseHours, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 10, 1),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Duration\n(hrs)", 
       title = "Avg. Sleep Duration by Hours of Phone Use Before Bed") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )

ggsave("Sleep_duration_bar.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: sleep-lollipop

df <- sleep_data |> filter(Measure == "AvgSleepQuality")


sleep_data |>
  filter(Measure == "AvgSleepQuality") |>
  ggplot(aes(x = PhoneUseHours, y = Value)) +
  geom_segment(aes(xend = PhoneUseHours, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "Avg. Sleep Quality by Hours of Phone Use Before Bed",
    x = " ",
    y = "Quality Report"
  ) +
  scale_y_continuous(
    limits = c(0, 10),
    breaks = seq(0, 10, by = 1),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")

ggsave("Sleep_quality_lollipop.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: sleep-scatter

sleep_data |>
  filter(Measure == "PercentFatigue") |>
  ggplot(aes(x = PhoneUseHours, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title = "% Reporting Fatigue by Hours of Phone Use Before Bed",
    x = " ",
    y = "% Fatigued"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("Sleep_fatigue_Scatter.png", device = "png", width = 14, height = 8)
```
Outdoor activity data story
```{r}
#| label: outdoors-bar
outdoors_data |>
  filter(Measure == "AvgHoursOutside") |>
  ggplot(aes(x = Temperature, y = Value)) +
  geom_col(fill = "steelblue", width = 0.4) +
  scale_y_continuous(breaks = seq(0, 10, 1),
                     expand = expansion(mult = c(0, 0.05))) +
  labs(x = " ", y = "Hours", 
       title = "Avg. Hours Outside per Week by Temperature (F)") +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),  
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold", 
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()   
  )

ggsave("Outside_hours_bar.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: outdoors-lollipop

df <- outdoors_data |> filter(Measure == "AvgHoursWalking")

outdoors_data |>
  filter(Measure == "AvgHoursWalking") |>
  ggplot(aes(x = Temperature, y = Value)) +
  geom_segment(aes(xend = Temperature, yend = 0), color = "blue", linewidth = 1.8) +
  geom_point(color = "blue", size = 7) +
  labs(
    title = "Avg. Hours Walking Outside per Week by Temperature (F)",
    x = " ",
    y = "Hours"
  ) +
  scale_y_continuous(
    limits = c(0, 8),
    breaks = seq(0, 8, by = 1),
    expand = c(0, 0)
  ) +
  theme_classic(base_size = 16) +
  theme(
    plot.title = element_text(
      size = 22, 
      face = "bold", 
      hjust = 0.5, 
      margin = margin(t = 20, b = 20)
    ),
    axis.text = element_text(size = 14),
    axis.title.x = element_text(size = 16, margin = margin(t = 20, b = 20)),
    axis.title.y = element_text(
      angle = 0,  # horizontal
      vjust = 1,
      hjust = 0.5,
      size = 16,
      margin = margin(r = 20)
    ),
    axis.ticks.x = element_blank(),
    plot.margin = margin(10, 20, 10, 40)
  ) +
  coord_cartesian(clip = "off")

ggsave("Outdoors_walking_lollipop.png", device = "png", width = 8, height = 5)
```

```{r}
#| label: outdoors-scatter

outdoors_data |>
  filter(Measure == "AvgOutings") |>
  ggplot(aes(x = Temperature, y = Value)) + 
  geom_point(color = "blue", size = 7) +
  scale_y_continuous(limits = c(0, 5)) +
  labs(
    title = "Avg. Outdoor Outings per Week by Temperature (F)",
    x = " ",
    y = "Outings"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 1.05, hjust = 0),
    plot.title = element_text(
      face = "bold",
      hjust = 0.5,
      size = 18,
      margin = margin(b = 50)  
    ),
    axis.ticks.x = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )

ggsave("Outdoors_outings_Scatter.png", device = "png", width = 14, height = 8)
```

